import{_ as p,c as e,b as n,d as s,e as o,a,o as r,r as c}from"./app.941c4894.js";const v=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":2,"title":"工程设计范式","slug":"工程设计范式","link":"#工程设计范式","children":[{"level":3,"title":"工程范式分类","slug":"工程范式分类","link":"#工程范式分类","children":[]},{"level":3,"title":"如何选择工程范式","slug":"如何选择工程范式","link":"#如何选择工程范式","children":[]}]},{"level":2,"title":"multi-repo VS mono-repo","slug":"multi-repo-vs-mono-repo","link":"#multi-repo-vs-mono-repo","children":[{"level":3,"title":"multi-repo","slug":"multi-repo","link":"#multi-repo","children":[]},{"level":3,"title":"mono-repo","slug":"mono-repo","link":"#mono-repo","children":[]},{"level":3,"title":"multi-repo 的管理","slug":"multi-repo-的管理","link":"#multi-repo-的管理","children":[]},{"level":3,"title":"mono-repo 的管理-lerna","slug":"mono-repo-的管理-lerna","link":"#mono-repo-的管理-lerna","children":[]},{"level":3,"title":"扩展资料","slug":"扩展资料","link":"#扩展资料","children":[]}]}],"relativePath":"front-end/engineering/package_design.md"}'),t={name:"front-end/engineering/package_design.md"},i=a(`<h2 id="工程设计范式" tabindex="-1">工程设计范式 <a class="header-anchor" href="#工程设计范式" aria-hidden="true">#</a></h2><ul><li>工程设计范式有哪些种类</li></ul><p>Rails Style / Domain Style</p><ul><li>相信很多有一定经验的开发者都会遇到选择这种问题 <ul><li>一个看似分层良好的古老工程，随着业务发展却越来越臃肿和低效</li><li>一个新的项目，因为这种隐形问题上的纠结，而耽误了自己时间和精力</li></ul></li></ul><h3 id="工程范式分类" tabindex="-1">工程范式分类 <a class="header-anchor" href="#工程范式分类" aria-hidden="true">#</a></h3><p>🍅 Rails Style</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// egg应用典型结构</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">── app</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── config</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── controller</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── extend</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── public</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── router</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ts</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── service</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── view</span></span>
<span class="line"><span style="color:#A6ACCD;">├── app</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ts</span></span>
<span class="line"><span style="color:#A6ACCD;">├── agent</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ts</span></span>
<span class="line"><span style="color:#A6ACCD;">├── config</span></span>
<span class="line"><span style="color:#A6ACCD;">├── logs</span></span>
<span class="line"><span style="color:#A6ACCD;">├── test</span></span>
<span class="line"><span style="color:#A6ACCD;">├── typings</span></span>
<span class="line"><span style="color:#A6ACCD;">├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">├── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">└── yarn</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">lock</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// Rails Style TodoList</span></span>
<span class="line"><span style="color:#A6ACCD;">root</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">── reducers</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoReducer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── fileterReducer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#A6ACCD;">├── actions</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoActions</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── filterAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#A6ACCD;">├── components</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoList</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoItem</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── filter</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">├── containers</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoListContainer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── todoItemContainer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── filterContainer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">├── App</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jsx</span></span>
<span class="line"><span style="color:#A6ACCD;">└── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><p>Rails Style 的特点</p><ul><li>专注于纵向的“层”的划分</li><li>同一类文件放置在同一目录下</li></ul></li><li><p>优势：</p><ul><li>便于合并导出</li><li>便于进行“层”的扩展</li></ul></li><li><p>不足：</p><ul><li>依赖关系难以直接地分析</li><li>对功能的修改会涉及到大量的目录切换</li><li>难以水平拆分</li></ul></li></ul><p>🍅 Domain style</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// Aant Design</span></span>
<span class="line"><span style="color:#A6ACCD;">├── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">├── components</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── util</span></span>
<span class="line"><span style="color:#A6ACCD;">        └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── alert</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── demo</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">en</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">US</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msd</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">zh</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">CN</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── style</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── anchor</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── Anchor</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── AnchorLink</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── __tests__</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── demo</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">en</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">US</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msd</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tsx</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── index</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">zh</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">CN</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── style</span></span>
<span class="line"><span style="color:#A6ACCD;">└── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><p>Domain style 的特点</p><ul><li>专注于横向的 “功能” 的划分</li><li>同一个 feature 放置在同一目录下</li></ul></li><li><p>优势：</p><ul><li>便于水平拆分</li><li>便于进行“功能”的扩展</li></ul></li><li><p>不足</p><ul><li>会产生大量的重复结构</li><li>难以垂直拆分</li></ul></li></ul><h3 id="如何选择工程范式" tabindex="-1">如何选择工程范式 <a class="header-anchor" href="#如何选择工程范式" aria-hidden="true">#</a></h3><ul><li>单一功能的项目 <ul><li>库、三方包：fs-extra、axios 等</li><li>由于不存在水平拆分的必要性、故可以选择 Rails Style</li><li>易于扩展</li><li>减少重复代码</li></ul></li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// Axios</span></span>
<span class="line"><span style="color:#A6ACCD;">root</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">── dist</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">├── examples</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">├── lib</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── adapters</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── cancel</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── core</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">     └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── defaults</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── axios</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#A6ACCD;">├── sandbox</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">├── test</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">├── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">└── webpack</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><p>聚合功能型项目</p><ul><li>组件池、utils：ant-design、element-ui、lodash 等</li><li>纵向分层少，极易横向扩展-故选择 Domain Style</li><li>易于添加新 feature</li><li>便于横向拆分</li></ul></li><li><p>业务工程项目</p><ul><li>即有大量的垂直分层，又有大量的 feature 聚合</li><li>Rails Style + Domain Style</li></ul></li></ul><h4 id="rails-style-对比-domain-style" tabindex="-1">🍅 Rails Style 对比 Domain Style <a class="header-anchor" href="#rails-style-对比-domain-style" aria-hidden="true">#</a></h4><table><thead><tr><th style="text-align:center;">工程设计范式</th><th style="text-align:center;">特点</th><th style="text-align:center;">优势</th><th style="text-align:center;">不足</th><th style="text-align:center;">适用项目</th></tr></thead><tbody><tr><td style="text-align:center;">Rails Style</td><td style="text-align:center;">纵向“层”的划分，同一类文件放置在同一目录下</td><td style="text-align:center;">便于合并导出，便于进行“层”的扩展</td><td style="text-align:center;">依赖关系难以直观地分析，对功能的修改会涉及到大量的目录切换 ，难以水平拆分</td><td style="text-align:center;">单一功能的项目</td></tr><tr><td style="text-align:center;">Domain Style</td><td style="text-align:center;">横向“功能”的划分，同一 feature 放置在同一目录下</td><td style="text-align:center;">便于水平拆分，便于进行“功能”的扩展</td><td style="text-align:center;">会产生大量的重复结构，难以垂直拆分</td><td style="text-align:center;">聚合功能型项目</td></tr></tbody></table><p>业务工程项目一般需要 Rails Style 和 Domain Style 结合</p><h2 id="multi-repo-vs-mono-repo" tabindex="-1">multi-repo VS mono-repo <a class="header-anchor" href="#multi-repo-vs-mono-repo" aria-hidden="true">#</a></h2><p>它们是什么？</p><p>这是两种代码风格仓库的管理风格</p><ul><li>multi-repo：把每个项目都分别用 git 托管</li><li>mono-repo：统一用一个 git 仓库管理所有的项目</li></ul><h3 id="multi-repo" tabindex="-1">multi-repo <a class="header-anchor" href="#multi-repo" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// multi-repo</span></span>
<span class="line"><span style="color:#A6ACCD;">root</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">a</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#A6ACCD;">├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">b</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── git</span></span>
<span class="line"><span style="color:#A6ACCD;">├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">c</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#A6ACCD;">├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">d</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ├── </span><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   └── </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#89DDFF;">...</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>从上面可以看出多个项目对应多个仓库，大多数工程，其实都是以 multi-repo 方式管理的</p><ul><li><p>优势：</p><p>可以让各项目团队根据需要定制更适合自己的 workflow</p></li><li><p>不足：</p><ol><li>难以对所有项目统一进行操作（git checkout / npm publish / npm run build）</li><li>难以追踪依赖关系（a-&gt;b-&gt;c）</li></ol></li></ul><h3 id="mono-repo" tabindex="-1">mono-repo <a class="header-anchor" href="#mono-repo" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// mono-repo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">├── </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#A6ACCD;">├── lerna</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">├── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">├── packages</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">a</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">b</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">c</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">        └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>广泛应用于一些知名开源项目和硅谷巨头（React/Angular/Vuetify/Google）</p><ul><li><p>优势</p><ol><li>方便统一地操作各个项目（git checkout / npm publish / npm run build）</li><li>利用工具，可以方便地追踪项目间的依赖关系</li></ol></li><li><p>不足：</p><ol><li>代码库随着业务发展会非常巨大</li><li>失去部分的灵活性（workflow 必须统一）</li><li>强依赖于 mono-repo 的管理工具</li></ol></li></ul><h3 id="multi-repo-的管理" tabindex="-1">multi-repo 的管理 <a class="header-anchor" href="#multi-repo-的管理" aria-hidden="true">#</a></h3><ul><li>git submodule</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># 初始化git submodules仓库</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule init</span></span>
<span class="line"><span style="color:#676E95;"># 添加一个submodule</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule add https://github.com</span></span>
<span class="line"><span style="color:#676E95;"># 更新所有的submodule</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule update</span></span>
<span class="line"><span style="color:#676E95;"># 查submodule status</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule status</span></span>
<span class="line"><span style="color:#676E95;"># foreach 用于在每个submodule中执行命令</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule foreach </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">git checkout -b featureA</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>git 提供的一种管理子仓库的方案</li><li>可以批量管理多个 git repo</li><li>本质上是一个父 repo 维护了一份各个子 repo 的清单</li><li>坑还是不少的：<a href="https://blog.devtang.com/2013/05/08/git-submodule-issues/" target="_blank" rel="noreferrer">git Submodule 的坑</a></li><li>替代方案：git subtree</li></ul><h3 id="mono-repo-的管理-lerna" tabindex="-1">mono-repo 的管理-lerna <a class="header-anchor" href="#mono-repo-的管理-lerna" aria-hidden="true">#</a></h3><ul><li>为 js 生态下的 mono-repo 管理提供一站式的解决方案</li><li>babel/create-react-app/jest/react-router/umi/nestjs</li></ul><p>解决方案：</p><p>mono-repo 下的依赖管理、版本管理、开发提效、工作流</p><h4 id="目录结构" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构" aria-hidden="true">#</a></h4><ul><li>整体作为一个 Git 仓库，也是个 npm 包（私有）</li><li>lerna.json 是整个 mono-repo 的配置文件</li><li>每个真正的项目，平铺在 packages/中</li><li>整个项目可以统一管理所有依赖（也可以分别管理）</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// lerna</span></span>
<span class="line"><span style="color:#A6ACCD;">├── </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#A6ACCD;">├── lerna</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">├── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">├── packages</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">a</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">b</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── project</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">c</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── README</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">md</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── __tests__</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── lib</span></span>
<span class="line"><span style="color:#A6ACCD;">        └── package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div>`,42),D={id:"用-lerna-管理项目实战",tabindex:"-1"},y=n("a",{class:"header-anchor",href:"#用-lerna-管理项目实战","aria-hidden":"true"},"#",-1),C=a(`<div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">npm i lerna -g</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna init</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol><li>初始化的目录结构</li></ol><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">- packages</span></span>
<span class="line"><span style="color:#A6ACCD;">  - lerna.json</span></span>
<span class="line"><span style="color:#A6ACCD;">  - package.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># 创建项目1</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna create pac-1</span></span>
<span class="line"><span style="color:#676E95;"># 创建项目2</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna create pac-2</span></span>
<span class="line"><span style="color:#676E95;"># 创建项目3</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna create pac-3</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>目录中 lerna.json</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// 配置$schema可以在vscode中，鼠标滑倒每个配置项时候，可以看每个配置项的介绍</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// 可以在https://www.schemastore.org/json/中网站查看知名项目的描述文件</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">$schema</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://json.schemastore.org/lerna</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">packages</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">packages/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">independent</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// 可以给各个项目发不同的版本</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>接下来我们为 pac-1、 pac-2、pac-3 添加依赖关系，我们制造这样一种依赖，pac-1 模块被 pac-2 依赖；pac-2 模块被 pac-3 模块依赖， 这时候就形成了 pac-1、 pac-2、pac-3 间接依赖关系。</p></div><ol start="2"><li>添加项目依赖</li></ol><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># 制造依赖关系，对于内部项目的依赖，lerna会以软链接的形式，给它们相互软链接起来</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna add pac-1 packages/pac-2</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna add pac-2 packages/pac-3</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果我们给项目添加外部依赖，可能需要给每个项目 <code>node_moudles</code> 都添加，同一个依赖会安装很多次，这显然不合理，为了解决这个问题，<code>lerna</code> 可以把依赖添加到项目根目录；<code>lerna clean</code>去清除每个项目中 node_modules 相同的依赖;用 <code>lerna bootstrap --hoist</code>重新安装依赖，</p><ol start="3"><li>发版</li></ol><p>需要注意是的 lerna.json 配置为&quot;version&quot;: &quot;independent&quot;时可以为每个包独立发不同的版本，如果&quot;version&quot;:&#39;0.0.0&#39;是发同样的版本</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">leran publish</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="4"><li>其它</li></ol><p>可以用<code>lerna -h</code>查看全部指令</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki has-diff"><code><span class="line"><span style="color:#A6ACCD;">lerna  </span><span style="color:#82AAFF;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">cmd</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">args...</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 执行每一个package.json你想指行的命令</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna run </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">script</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 执行package.josn 中script配置的命令</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna diff </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">pkgName</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;"># 对比 文件变化</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna changed </span><span style="color:#676E95;"># 查看文件变化</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="lerna-json-配置" tabindex="-1">lerna.json 配置 <a class="header-anchor" href="#lerna-json-配置" aria-hidden="true">#</a></h4><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">npmClient</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">npmClientArgs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--pure-lockfile</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">command</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">publish</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">ignoreChanges</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ignored-file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*.md</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">chore(replease):publish</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">registry</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://npm.pkg.github.com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">bootstrap</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">ignore</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">component-*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">npmClientArgs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--no-package-lock</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">packages</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">packages/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li><p>其实只有几个主要字段：version、npm*、command、packages</p></li><li><p>command 配置-json schema 查看</p><ul><li>配置 lerna 子命令的默认项目</li></ul></li><li><p>version: 决定 fixed mode / independent mode</p></li><li><p>packages：项目路径</p></li><li><p>npm*：解耦包管理工具</p></li></ul><div class="tip custom-block"><p class="custom-block-title">一些注意项</p><ul><li>mono-repo 不可嵌套</li><li>mono-repo 的主仓库必须是私有的（private：true）</li><li>如果你对仓库的私密性要求非常高，甚至可以不用 npm 而使用 git 应用依赖</li><li>任何的 json 配置记不住，都可以用 json schema</li></ul></div><h4 id="lerna-外的选择-nx" tabindex="-1">lerna 外的选择-nx <a class="header-anchor" href="#lerna-外的选择-nx" aria-hidden="true">#</a></h4><ul><li>Angular 出品</li><li>框架强相关：Angular、React</li><li>支持插件机制</li><li>远超 mono-repo 管理的强大功能</li></ul><h3 id="扩展资料" tabindex="-1">扩展资料 <a class="header-anchor" href="#扩展资料" aria-hidden="true">#</a></h3><p><a href="https://blog.devtang.com/2013/05/08/git-submodule-issues/" target="_blank" rel="noreferrer">Git submodule 的坑</a></p><p><a href="https://github.com/apenwarr/git-subtree/" target="_blank" rel="noreferrer">git subtree</a></p><p><a href="https://blog.npmjs.org/post/617484925547986944/npm-v7-series-introduction" target="_blank" rel="noreferrer">npm v7 Series - Introduction</a></p><p><a href="https://nx.dev/" target="_blank" rel="noreferrer">NX</a></p>`,27);function A(F,u,b,d,m,h){const l=c("Badge");return r(),e("div",null,[i,n("h4",D,[s("用 lerna 管理项目实战 "),o(l,{text:"重要",type:"tip"}),s(),y]),C])}const _=p(t,[["render",A]]);export{v as __pageData,_ as default};
